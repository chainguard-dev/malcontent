rule Macos_Infostealer_Wallets_8e469ea0 {
    meta:
        author = "Elastic Security"
        id = "8e469ea0-0c68-444b-b19a-4e1ab89f94b2"
        fingerprint = "ef913d90c42c8ed1ac47a0057e5e1cb7d5b2de66fe13b088724e87e223d6c377"
        creation_date = "2024-03-06"
        last_modified = "2024-08-26"
        threat_name = "Macos.Infostealer.Wallets"
        reference_sample = "0e649facc5c82f7112997c7629bd114e63acc1c8dc9ede646214243ace9b9c1d"
        severity = 100
        arch_context = "x86, arm64"
        scan_context = "file, memory"
        license = "Elastic License v2"
        os = "macos"
    strings:
        $s1 = {49 62 6E 65 6A 64 66 6A 6D 6D 6B 70 63 6E 6C 70 65 62 6B 6C 6D 6E 6B 6F 65 6F 69 68 6F 66 65 63}
        $s2 = {66 68 62 6F 68 69 6D 61 65 6C 62 6F 68 70 6A 62 62 6C 64 63 6E 67 63 6E 61 70 6E 64 6F 64 6A 70}
        $s3 = {66 66 6E 62 65 6C 66 64 6F 65 69 6F 68 65 6E 6B 6A 69 62 6E 6D 61 64 6A 69 65 68 6A 68 61 6A 62}
        $s4 = {6A 62 64 61 6F 63 6E 65 69 69 69 6E 6D 6A 62 6A 6C 67 61 6C 68 63 65 6C 67 62 65 6A 6D 6E 69 64}
        $s5 = {61 66 62 63 62 6A 70 62 70 66 61 64 6C 6B 6D 68 6D 63 6C 68 6B 65 65 6F 64 6D 61 6D 63 66 6C 63}
        $s6 = {68 6E 66 61 6E 6B 6E 6F 63 66 65 6F 66 62 64 64 67 63 69 6A 6E 6D 68 6E 66 6E 6B 64 6E 61 61 64}
        $s7 = {68 70 67 6C 66 68 67 66 6E 68 62 67 70 6A 64 65 6E 6A 67 6D 64 67 6F 65 69 61 70 70 61 66 6C 6E}
        $s8 = {62 6C 6E 69 65 69 69 66 66 62 6F 69 6C 6C 6B 6E 6A 6E 65 70 6F 67 6A 68 6B 67 6E 6F 61 70 61 63}
        $s9 = {63 6A 65 6C 66 70 6C 70 6C 65 62 64 6A 6A 65 6E 6C 6C 70 6A 63 62 6C 6D 6A 6B 66 63 66 66 6E 65}
        $s10 = {66 69 68 6B 61 6B 66 6F 62 6B 6D 6B 6A 6F 6A 70 63 68 70 66 67 63 6D 68 66 6A 6E 6D 6E 66 70 69}
        $s11 = {6B 6E 63 63 68 64 69 67 6F 62 67 68 65 6E 62 62 61 64 64 6F 6A 6A 6E 6E 61 6F 67 66 70 70 66 6A}
        $s12 = {61 6D 6B 6D 6A 6A 6D 6D 66 6C 64 64 6F 67 6D 68 70 6A 6C 6F 69 6D 69 70 62 6F 66 6E 66 6A 69 68}
        $s13 = {6E 6C 62 6D 6E 6E 69 6A 63 6E 6C 65 67 6B 6A 6A 70 63 66 6A 63 6C 6D 63 66 67 67 66 65 66 64 6D}
        $s14 = {6E 61 6E 6A 6D 64 6B 6E 68 6B 69 6E 69 66 6E 6B 67 64 63 67 67 63 66 6E 68 64 61 61 6D 6D 6D 6A}
        $s15 = {6E 6B 64 64 67 6E 63 64 6A 67 6A 66 63 64 64 61 6D 66 67 63 6D 66 6E 6C 68 63 63 6E 69 6D 69 67}
        $s16 = {66 6E 6A 68 6D 6B 68 68 6D 6B 62 6A 6B 6B 61 62 6E 64 63 6E 6E 6F 67 61 67 6F 67 62 6E 65 65 63}
        $s17 = {63 70 68 68 6C 67 6D 67 61 6D 65 6F 64 6E 68 6B 6A 64 6D 6B 70 61 6E 6C 65 6C 6E 6C 6F 68 61 6F}
        $s18 = {6E 68 6E 6B 62 6B 67 6A 69 6B 67 63 69 67 61 64 6F 6D 6B 70 68 61 6C 61 6E 6E 64 63 61 70 6A 6B}
        $s19 = {6B 70 66 6F 70 6B 65 6C 6D 61 70 63 6F 69 70 65 6D 66 65 6E 64 6D 64 63 67 68 6E 65 67 69 6D 6E}
        $s20 = {61 69 69 66 62 6E 62 66 6F 62 70 6D 65 65 6B 69 70 68 65 65 69 6A 69 6D 64 70 6E 6C 70 67 70 70}
        $s21 = {64 6D 6B 61 6D 63 6B 6E 6F 67 6B 67 63 64 66 68 68 62 64 64 63 67 68 61 63 68 6B 65 6A 65 61 70}
        $s22 = {66 68 6D 66 65 6E 64 67 64 6F 63 6D 63 62 6D 66 69 6B 64 63 6F 67 6F 66 70 68 69 6D 6E 6B 6E 6F}
        $s23 = {63 6E 6D 61 6D 61 61 63 68 70 70 6E 6B 6A 67 6E 69 6C 64 70 64 6D 6B 61 61 6B 65 6A 6E 68 61 65}
        $s24 = {6A 6F 6A 68 66 65 6F 65 64 6B 70 6B 67 6C 62 66 69 6D 64 66 61 62 70 64 66 6A 61 6F 6F 6C 61 66}
        $s25 = {66 6C 70 69 63 69 69 6C 65 6D 67 68 62 6D 66 61 6C 69 63 61 6A 6F 6F 6C 68 6B 6B 65 6E 66 65 6C}
        $s26 = {6E 6B 6E 68 69 65 68 6C 6B 6C 69 70 70 61 66 61 6B 61 65 6B 6C 62 65 67 6C 65 63 69 66 68 61 64}
        $s27 = {68 63 66 6C 70 69 6E 63 70 70 70 64 63 6C 69 6E 65 61 6C 6D 61 6E 64 69 6A 63 6D 6E 6B 62 67 6E}
        $s28 = {6F 6F 6B 6A 6C 62 6B 69 69 6A 69 6E 68 70 6D 6E 6A 66 66 63 6F 66 6A 6F 6E 62 66 62 67 61 6F 63}
        $s29 = {6D 6E 66 69 66 65 66 6B 61 6A 67 6F 66 6B 63 6A 6B 65 6D 69 64 69 61 65 63 6F 63 6E 6B 6A 65 68}
        $s30 = {6C 6F 64 63 63 6A 6A 62 64 68 66 61 6B 61 65 6B 64 69 61 68 6D 65 64 66 62 69 65 6C 64 67 69 6B}
        $s31 = {49 6A 6D 70 67 6B 6A 66 6B 62 66 68 6F 65 62 67 6F 67 66 6C 66 65 62 6E 6D 65 6A 6D 66 62 6D 6C}
        $s32 = {6C 6B 63 6A 6C 6E 6A 66 70 62 69 6B 6D 63 6D 62 61 63 68 6A 70 64 62 69 6A 65 6A 66 6C 70 63 6D}
        $s33 = {6E 6B 62 69 68 66 62 65 6F 67 61 65 61 6F 65 68 6C 65 66 6E 6B 6F 64 62 65 66 67 70 67 6B 6E 6E}
        $s34 = {62 63 6F 70 67 63 68 68 6F 6A 6D 67 67 6D 66 66 69 6C 70 6C 6D 62 64 69 63 67 61 69 68 6C 6B 70}
        $s35 = {6B 6C 6E 61 65 6A 6A 67 62 69 62 6D 68 6C 65 70 68 6E 68 70 6D 61 6F 66 6F 68 67 6B 70 67 6B 64}
        $s36 = {61 65 61 63 68 6B 6E 6D 65 66 70 68 65 70 63 63 69 6F 6E 62 6F 6F 68 63 6B 6F 6E 6F 65 65 6D 67}
        $s37 = {64 6B 64 65 64 6C 70 67 64 6D 6D 6B 6B 66 6A 61 62 66 66 65 67 61 6E 69 65 61 6D 66 6B 6C 6B 6D}
        $s38 = {6E 6C 67 62 68 64 66 67 64 68 67 62 69 61 6D 66 64 66 6D 62 69 6B 63 64 67 68 69 64 6F 61 64 64}
        $s39 = {6F 6E 6F 66 70 6E 62 62 6B 65 68 70 6D 6D 6F 61 62 67 70 63 70 6D 69 67 61 66 6D 6D 6E 6A 68 6C}
        $s40 = {63 69 68 6D 6F 61 64 61 69 67 68 63 65 6A 6F 70 61 6D 6D 66 62 6D 64 64 63 6D 64 65 6B 63 6A 65}
        $s41 = {63 67 65 65 6F 64 70 66 61 67 6A 63 65 65 66 69 65 66 6C 6D 64 66 70 68 70 6C 6B 65 6E 6C 66 6B}
        $s42 = {70 64 61 64 6A 6B 66 6B 67 63 61 66 67 62 63 65 69 6D 63 70 62 6B 61 6C 6E 66 6E 65 70 62 6E 6B}
        $s43 = {61 63 6D 61 63 6F 64 6B 6A 62 64 67 6D 6F 6C 65 65 62 6F 6C 6D 64 6A 6F 6E 69 6C 6B 64 62 63 68}
        $s44 = {62 66 6E 61 65 6C 6D 6F 6D 65 69 6D 68 6C 70 6D 67 6A 6E 6A 6F 70 68 68 70 6B 6B 6F 6C 6A 70 61}
        $s45 = {66 68 69 6C 61 68 65 69 6D 67 6C 69 67 6E 64 64 6B 6A 67 6F 66 6B 63 62 67 65 6B 68 65 6E 62 68}
        $s46 = {6D 67 66 66 6B 66 62 69 64 69 68 6A 70 6F 61 6F 6D 61 6A 6C 62 67 63 68 64 64 6C 69 63 67 70 6E}
        $s47 = {68 6D 65 6F 62 6E 66 6E 66 63 6D 64 6B 64 63 6D 6C 62 6C 67 61 67 6D 66 70 66 62 6F 69 65 61 66}
        $s48 = {6C 70 66 63 62 6A 6B 6E 69 6A 70 65 65 69 6C 6C 69 66 6E 6B 69 6B 67 6E 63 69 6B 67 66 68 64 6F}
        $s49 = {64 6E 67 6D 6C 62 6C 63 6F 64 66 6F 62 70 64 70 65 63 61 61 64 67 66 62 63 67 67 66 6A 66 6E 6D}
        $s50 = {62 68 68 68 6C 62 65 70 64 6B 62 61 70 61 64 6A 64 6E 6E 6F 6A 6B 62 67 69 6F 69 6F 64 62 69 63}
        $s51 = {6A 6E 6B 65 6C 66 61 6E 6A 6B 65 61 64 6F 6E 65 63 61 62 65 68 61 6C 6D 62 67 70 66 6F 64 6A 6D}
        $s52 = {6A 68 67 6E 62 6B 6B 69 70 61 61 6C 6C 70 65 68 62 6F 68 6A 6D 6B 62 6A 6F 66 6A 64 6D 65 69 64}
        $s53 = {6A 6E 6C 67 61 6D 65 63 62 70 6D 62 61 6A 6A 66 68 6D 6D 6D 6C 68 65 6A 6B 65 6D 65 6A 64 6D 61}
        $s54 = {6B 6B 70 6C 6C 6B 6F 64 6A 65 6C 6F 69 64 69 65 65 64 6F 6A 6F 67 61 63 66 68 70 61 69 68 6F 68}
        $s55 = {6D 63 6F 68 69 6C 6E 63 62 66 61 68 62 6D 67 64 6A 6B 62 70 65 6D 63 63 69 69 6F 6C 67 63 67 65}
        $s56 = {67 6A 61 67 6D 67 69 64 64 62 62 63 69 6F 70 6A 68 6C 6C 6B 64 6E 64 64 68 63 67 6C 6E 65 6D 6B}
        $s57 = {6B 6D 68 63 69 68 70 65 62 66 6D 70 67 6D 69 68 62 6B 69 70 6D 6A 6C 6D 6D 69 6F 61 6D 65 6B 61}
        $s58 = {70 68 6B 62 61 6D 65 66 69 6E 67 67 6D 61 6B 67 6B 6C 70 6B 6C 6A 6A 6D 67 69 62 6F 68 6E 62 61}
        $s59 = {6C 70 69 6C 62 6E 69 69 61 62 61 63 6B 64 6A 63 69 6F 6E 6B 6F 62 67 6C 6D 64 64 66 62 63 6A 6F}
        $s60 = {63 6A 6D 6B 6E 64 6A 68 6E 61 67 63 66 62 70 69 65 6D 6E 6B 64 70 6F 6D 63 63 6E 6A 62 6C 6D 6A}
        $s61 = {61 69 6A 63 62 65 64 6F 69 6A 6D 67 6E 6C 6D 6A 65 65 67 6A 61 67 6C 6D 65 70 62 6D 70 6B 70 69}
        $s62 = {65 66 62 67 6C 67 6F 66 6F 69 70 70 62 67 63 6A 65 70 6E 68 69 62 6C 61 69 62 63 6E 63 6C 67 6B}
        $s63 = {6F 64 62 66 70 65 65 69 68 64 6B 62 69 68 6D 6F 70 6B 62 6A 6D 6F 6F 6E 66 61 6E 6C 62 66 63 6C}
        $s64 = {66 6E 6E 65 67 70 68 6C 6F 62 6A 64 70 6B 68 65 63 61 70 6B 69 6A 6A 64 6B 67 63 6A 68 6B 69 62}
        $s65 = {61 6F 64 6B 6B 61 67 6E 61 64 63 62 6F 62 66 70 67 67 66 6E 6A 65 6F 6E 67 65 6D 6A 62 6A 63 61}
        $s66 = {61 6B 6F 69 61 69 62 6E 65 70 63 65 64 63 70 6C 69 6A 6D 69 61 6D 6E 61 69 67 62 65 70 6D 63 62}
        $s67 = {65 6A 62 61 6C 62 61 6B 6F 70 6C 63 68 6C 67 68 65 63 64 61 6C 6D 65 65 65 61 6A 6E 69 6D 68 6D}
        $s68 = {64 66 65 63 63 61 64 6C 69 6C 70 6E 64 6A 6A 6F 68 62 6A 64 62 6C 65 70 6D 6A 65 61 68 6C 6D 6D}
        $s69 = {6B 6A 6D 6F 6F 68 6C 67 6F 6B 63 63 6F 64 69 63 6A 6A 66 65 62 66 6F 6D 6C 62 6C 6A 67 66 68 6B}
        $s70 = {61 6A 6B 68 6F 65 69 69 6F 6B 69 67 68 6C 6D 64 6E 6C 61 6B 70 6A 66 6F 6F 62 6E 6A 69 6E 69 65}
        $s71 = {66 70 6C 66 69 70 6D 61 6D 63 6A 61 6B 6E 70 67 6E 69 70 6A 65 61 65 65 69 64 6E 6A 6F 6F 61 6F}
        $s72 = {6E 69 69 68 66 6F 6B 64 6C 69 6D 62 64 64 68 66 6D 6E 67 6E 70 6C 67 66 63 67 70 6D 6C 69 64 6F}
        $s73 = {6F 62 66 66 6B 6B 61 67 70 6D 6F 68 65 6E 6E 69 70 6A 6F 6B 6D 70 6C 6C 6F 63 6E 6C 6E 64 61 63}
        $s74 = {6B 66 6F 63 6E 6C 64 64 66 61 68 69 68 6F 61 6C 69 6E 6E 66 62 6E 66 6D 6F 70 6A 6F 6B 6D 68 6C}
        $s75 = {69 6E 66 65 62 6F 61 6A 67 66 68 67 62 6A 70 6A 62 65 70 70 62 6B 67 6E 61 62 66 64 6B 64 61 66}
        $s76 = {7B 35 33 30 66 37 63 36 63 2D 36 30 37 37 2D 34 37 30 33 2D 38 66 37 31 2D 63 62 33 36 38 63 36 36 33 65 33 35 7D 2E 78 70 69}
        $s77 = {72 6F 6E 69 6E 2D 77 61 6C 6C 65 74 40 61 78 69 65 69 6E 66 69 6E 69 74 79 2E 63 6F 6D 2E 78 70 69}
        $s78 = {77 65 62 65 78 74 65 6E 73 69 6F 6E 40 6D 65 74 61 6D 61 73 6B 2E 69 6F 2E 78 70 69}
        $s79 = {7B 35 37 39 39 64 39 62 36 2D 38 33 34 33 2D 34 63 32 36 2D 39 61 62 36 2D 35 64 32 61 64 33 39 38 38 34 63 65 7D 2E 78 70 69}
        $s80 = {7B 61 61 38 31 32 62 65 65 2D 39 65 39 32 2D 34 38 62 61 2D 39 35 37 30 2D 35 66 61 66 30 63 66 65 32 35 37 38 7D 2E 78 70 69}
        $s81 = {7B 35 39 65 61 35 66 32 39 2D 36 65 61 39 2D 34 30 62 35 2D 38 33 63 64 2D 39 33 37 32 34 39 62 30 30 31 65 31 7D 2E 78 70 69}
        $s82 = {7B 64 38 64 64 66 63 32 61 2D 39 37 64 39 2D 34 63 36 30 2D 38 62 35 33 2D 35 65 64 64 32 39 39 62 36 36 37 34 7D 2E 78 70 69}
        $s83 = {7B 37 63 34 32 65 65 61 31 2D 62 33 65 34 2D 34 62 65 34 2D 61 35 36 66 2D 38 32 61 35 38 35 32 62 31 32 64 63 7D 2E 78 70 69}
        $s84 = {7B 62 33 65 39 36 62 35 66 2D 62 35 62 66 2D 38 62 34 38 2D 38 34 36 62 2D 35 32 66 34 33 30 33 36 35 65 38 30 7D 2E 78 70 69}
        $s85 = {7B 65 62 31 66 62 35 37 62 2D 63 61 33 64 2D 34 36 32 34 2D 61 38 34 31 2D 37 32 38 66 64 62 32 38 34 35 35 66 7D 2E 78 70 69}
        $s86 = {7B 37 36 35 39 36 65 33 30 2D 65 63 64 62 2D 34 37 37 61 2D 39 31 66 64 2D 63 30 38 66 32 30 31 38 64 66 31 61 7D 2E 78 70 69}
        $s87 = {65 6A 6A 6C 61 64 69 6E 6E 63 6B 64 67 6A 65 6D 65 6B 65 62 64 70 65 6F 6B 62 69 6B 68 66 63 69}
        $s88 = {62 67 70 69 70 69 6D 69 63 6B 65 61 64 6B 6A 6C 6B 6C 67 63 69 69 66 68 6E 61 6C 68 64 6A 68 65}
        $s89 = {65 70 61 70 69 68 64 70 6C 61 6A 63 64 6E 6E 6B 64 65 69 61 68 6C 67 69 67 6F 66 6C 6F 69 62 67}
        $s90 = {61 68 6F 6C 70 66 64 69 61 6C 6A 67 6A 66 68 6F 6D 69 68 6B 6A 62 6D 67 6A 69 64 6C 63 64 6E 6F}
        $s91 = {65 67 6A 69 64 6A 62 70 67 6C 69 63 68 64 63 6F 6E 64 62 63 62 64 6E 62 65 65 70 70 67 64 70 68}
        $s92 = {70 6E 6E 64 70 6C 63 62 6B 61 6B 63 70 6C 6B 6A 6E 6F 6C 67 62 6B 64 67 6A 69 6B 6A 65 64 6E 6D}
        $s93 = {67 6F 6A 68 63 64 67 63 70 62 70 66 69 67 63 61 65 6A 70 66 68 66 65 67 65 6B 64 67 69 62 6C 6B}
    condition:
        6 of them
}

