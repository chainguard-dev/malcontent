## linux/clean/redis-server.aarch64 [ðŸŸ¡ MEDIUM]

| RISK | KEY | DESCRIPTION | EVIDENCE |
|:--|:--|:--|:--|
| MEDIUM | [c2/addr/ip](https://github.com/chainguard-dev/malcontent/blob/main/rules/c2/addr/ip.yara#ip_port_mention) | mentions an IP and port | [master_port](https://github.com/search?q=master_port&type=code)<br>[updatePort](https://github.com/search?q=updatePort&type=code)<br>[host_port](https://github.com/search?q=host_port&type=code)<br>[tcp_port](https://github.com/search?q=tcp_port&type=code)<br>[bus_port](https://github.com/search?q=bus_port&type=code)<br>[prev_ip](https://github.com/search?q=prev_ip&type=code)<br>[IP](https://github.com/search?q=IP&type=code) |
| MEDIUM | [crypto/openssl](https://github.com/chainguard-dev/malcontent/blob/main/rules/crypto/openssl.yara#openssl_user) | Uses OpenSSL | [OpenSSL](https://github.com/search?q=OpenSSL&type=code) |
| MEDIUM | [discover/user/name_get](https://github.com/chainguard-dev/malcontent/blob/main/rules/discover/user/username-get.yara#whoami) | [returns the user name running this process](https://man7.org/linux/man-pages/man1/whoami.1.html) | [whoami](https://github.com/search?q=whoami&type=code) |
| MEDIUM | [exec/cmd](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/cmd/cmd.yara#exec) | executes a command | [replicaStartCommandStream](https://github.com/search?q=replicaStartCommandStream&type=code)<br>[execCommandAbort](https://github.com/search?q=execCommandAbort&type=code) |
| MEDIUM | [exec/dylib/symbol_address](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/dylib/symbol-address.yara#dlsym) | [get the address of a symbol](https://man7.org/linux/man-pages/man3/dlsym.3.html) | [dlsym](https://github.com/search?q=dlsym&type=code) |
| MEDIUM | [exec/program](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/program/program.yara#execve) | executes external programs | [execve](https://github.com/search?q=execve&type=code) |
| MEDIUM | [exec/shell/echo](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/shell/echo.yara#elf_calls_shell_echo) | [program generates text with echo command](https://linux.die.net/man/1/echo) | [echo tsc > /sys/devices/system/clocksource/clocksource0/current_clock](https://github.com/search?q=echo+tsc+%3E+%2Fsys%2Fdevices%2Fsystem%2Fclocksource%2Fclocksource0%2Fcurrent_clock&type=code)<br>[echo madvise > /sys/kernel/mm/transparent_hugepage/enabled' as root](https://github.com/search?q=echo+madvise+%3E+%2Fsys%2Fkernel%2Fmm%2Ftransparent_hugepage%2Fenabled%27+as+root&type=code)<br>[echo never > /sys/kernel/mm/transparent_hugepage/enabled'](https://github.com/search?q=echo+never+%3E+%2Fsys%2Fkernel%2Fmm%2Ftransparent_hugepage%2Fenabled%27&type=code)<br>[echo 'maxmemory 128mb'](https://github.com/search?q=echo+%27maxmemory+128mb%27&type=code) |
| MEDIUM | [fs/file/create](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file/file-create.yara#CreateFile) | create a new file | [CreateFileEvent](https://github.com/search?q=CreateFileEvent&type=code) |
| MEDIUM | [fs/file/delete](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file/file-delete.yara#DeleteFile) | delete a file | [DeleteFileEvent](https://github.com/search?q=DeleteFileEvent&type=code) |
| MEDIUM | [fs/file/times_set](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file/file-times-set.yara#shell_toucher) | change file timestamps | [touch the specified keys](https://github.com/search?q=touch+the+specified+keys&type=code) |
| MEDIUM | [fs/path/relative](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/path/relative.yara#relative_path_val) | references and possibly executes relative path | [./redis-check-aof](https://github.com/search?q=.%2Fredis-check-aof&type=code)<br>[./redis-server](https://github.com/search?q=.%2Fredis-server&type=code) |
| MEDIUM | [fs/path/tmp](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/path/tmp.yara#tmp_path) | path reference within /tmp | [/tmp/dump.hex](https://github.com/search?q=%2Ftmp%2Fdump.hex&type=code)<br>[/tmp/dump.bin](https://github.com/search?q=%2Ftmp%2Fdump.bin&type=code) |
| MEDIUM | [fs/permission/modify](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/permission/permission-modify.yara#chmod) | [modifies file permissions](https://linux.die.net/man/1/chmod) | [chmod](https://github.com/search?q=chmod&type=code) |
| MEDIUM | [fs/proc/arbitrary_pid](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/proc/arbitrary-pid.yara#proc_arbitrary) | access /proc for arbitrary pids | [/proc/%ld/smaps](https://github.com/search?q=%2Fproc%2F%25ld%2Fsmaps&type=code) |
| MEDIUM | [impact/remote_access/heartbeat](https://github.com/chainguard-dev/malcontent/blob/main/rules/impact/remote_access/heartbeat.yara#heartbeat) | references a 'heartbeat' | [RedisModule_SendChildHeartbeat](https://github.com/search?q=RedisModule_SendChildHeartbeat&type=code)<br>[RM_SendChildHeartbeat](https://github.com/search?q=RM_SendChildHeartbeat&type=code) |
| MEDIUM | [net/http/post](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/http/post.yara#http_post) | submits content to websites | [POST](https://github.com/search?q=POST&type=code)<br>[http](https://github.com/search?q=http&type=code) |
| MEDIUM | [net/ip/addr](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/ip/addr.yara#ip_addr) | mentions an 'IP address' | [IP address](https://github.com/search?q=IP+address&type=code) |
| MEDIUM | [net/ip/host_port](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/ip/host_port.yara#host_port_ref) | connects to an arbitrary hostname:port | [hostname and port](https://github.com/search?q=hostname+and+port&type=code)<br>[host and port](https://github.com/search?q=host+and+port&type=code)<br>`$host_port`<br>[host-port](https://github.com/search?q=host-port&type=code) |
| MEDIUM | [net/ip/parse](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/ip/ip-parse.yara#inet_pton) | parses IP address (IPv4 or IPv6) | [inet_pton](https://github.com/search?q=inet_pton&type=code) |
| MEDIUM | [net/ip/string](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/ip/ip-string.yara#inet_ntoa) | [converts IP address from byte to string](https://linux.die.net/man/3/inet_ntoa) | [inet_ntop](https://github.com/search?q=inet_ntop&type=code) |
| MEDIUM | [net/socket/listen](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket/socket-listen.yara#listen) | generic listen string | [socket](https://github.com/search?q=socket&type=code)<br>[listen](https://github.com/search?q=listen&type=code)<br>[accept](https://github.com/search?q=accept&type=code) |
| MEDIUM | [net/socket/reuseport](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket/reuseport.yara#reuseport) | reuse TCP/IP ports for listening and connecting | [SO_REUSEADDR](https://github.com/search?q=SO_REUSEADDR&type=code) |
| MEDIUM | [persist/daemon](https://github.com/chainguard-dev/malcontent/blob/main/rules/persist/daemon/daemon.yara#daemon) | Run as a background daemon | [daemonize](https://github.com/search?q=daemonize&type=code) |
| MEDIUM | [persist/pid_file](https://github.com/chainguard-dev/malcontent/blob/main/rules/persist/pid_file.yara#pid_file) | pid file, likely DIY daemon | [/var/run/redis.pid](https://github.com/search?q=%2Fvar%2Frun%2Fredis.pid&type=code)<br>[createPidFile](https://github.com/search?q=createPidFile&type=code) |
| MEDIUM | [process/name_set](https://github.com/chainguard-dev/malcontent/blob/main/rules/process/name-set.yara#__progname) | [get or set the current process name](https://stackoverflow.com/questions/273691/using-progname-instead-of-argv0) | [__progname](https://github.com/search?q=__progname&type=code) |
| MEDIUM | [sus/exclamation](https://github.com/chainguard-dev/malcontent/blob/main/rules/sus/exclamation.yara#exclamations) | gets very excited | [Sentinel was not able to save the new configuration on disk!!!](https://github.com/search?q=Sentinel+was+not+able+to+save+the+new+configuration+on+disk%21%21%21&type=code)<br>[Check your memory ASAP !!!](https://github.com/search?q=Check+your+memory+ASAP+%21%21%21&type=code) |
| LOW | [anti-behavior/random_behavior](https://github.com/chainguard-dev/malcontent/blob/main/rules/anti-behavior/random_behavior.yara#random) | uses a random number generator | [RedisModule_GetRandomHexChars](https://github.com/search?q=RedisModule_GetRandomHexChars&type=code)<br>[RedisModule_GetRandomBytes](https://github.com/search?q=RedisModule_GetRandomBytes&type=code)<br>[ziplistRandomPairsUnique](https://github.com/search?q=ziplistRandomPairsUnique&type=code)<br>[hashTypeRandomElement](https://github.com/search?q=hashTypeRandomElement&type=code)<br>[RedisModule_RandomKey](https://github.com/search?q=RedisModule_RandomKey&type=code)<br>[zsetTypeRandomElement](https://github.com/search?q=zsetTypeRandomElement&type=code)<br>[redis_math_randomseed](https://github.com/search?q=redis_math_randomseed&type=code)<br>[dictGetFairRandomKey](https://github.com/search?q=dictGetFairRandomKey&type=code)<br>[RM_GetRandomHexChars](https://github.com/search?q=RM_GetRandomHexChars&type=code)<br>[lpRandomPairsUnique](https://github.com/search?q=lpRandomPairsUnique&type=code)<br>[memtest_fill_random](https://github.com/search?q=memtest_fill_random&type=code)<br>[getRandomHexChars](https://github.com/search?q=getRandomHexChars&type=code)<br>[RM_GetRandomBytes](https://github.com/search?q=RM_GetRandomBytes&type=code)<br>[setTypePopRandom](https://github.com/search?q=setTypePopRandom&type=code)<br>[dictGetRandomKey](https://github.com/search?q=dictGetRandomKey&type=code)<br>[randomkeyCommand](https://github.com/search?q=randomkeyCommand&type=code)<br>[lpRandomEntries](https://github.com/search?q=lpRandomEntries&type=code)<br>[zslRandomLevel](https://github.com/search?q=zslRandomLevel&type=code)<br>[getRandomBytes](https://github.com/search?q=getRandomBytes&type=code)<br>[raxRandomWalk](https://github.com/search?q=raxRandomWalk&type=code)<br>[RM_RandomKey](https://github.com/search?q=RM_RandomKey&type=code)<br>[pseudorandom](https://github.com/search?q=pseudorandom&type=code)<br>[lpNextRandom](https://github.com/search?q=lpNextRandom&type=code)<br>[intsetRandom](https://github.com/search?q=intsetRandom&type=code)<br>[dbRandomKey](https://github.com/search?q=dbRandomKey&type=code)<br>[urandom](https://github.com/search?q=urandom&type=code)<br>[srandom](https://github.com/search?q=srandom&type=code) |
| LOW | [c2/addr/url](https://github.com/chainguard-dev/malcontent/blob/main/rules/c2/addr/url.yara#binary_with_url) | binary contains hardcoded URL | [http://pyropus.ca/software/memtester/](http://pyropus.ca/software/memtester/)<br>[http://github.com/redis/redis/issues](http://github.com/redis/redis/issues)<br>[https://redis.io/commands/slowlog](https://redis.io/commands/slowlog)<br>[https://redis.io/topics/latency](https://redis.io/topics/latency)<br>[http://www.memtest86.com/](http://www.memtest86.com/) |
| LOW | [c2/tool_transfer/arch](https://github.com/chainguard-dev/malcontent/blob/main/rules/c2/tool_transfer/arch.yara#arch_ref) | references a specific architecture | [https://](https://)<br>[http://](http://)<br>[x86](https://github.com/search?q=x86&type=code) |
| LOW | [c2/tool_transfer/os](https://github.com/chainguard-dev/malcontent/blob/main/rules/c2/tool_transfer/os.yara#os_ref) | references a specific operating system | [https://](https://)<br>[http://](http://)<br>[Linux](https://github.com/search?q=Linux&type=code)<br>[linux](https://github.com/search?q=linux&type=code) |
| LOW | [credential/password](https://github.com/chainguard-dev/malcontent/blob/main/rules/credential/password/password.yara#password) | references a 'password' | [authentication password for the default](https://github.com/search?q=authentication+password+for+the+default&type=code)<br>[username-password pair or user is](https://github.com/search?q=username-password+pair+or+user+is&type=code)<br>[for the output password](https://github.com/search?q=for+the+output+password&type=code)<br>[the number of password](https://github.com/search?q=the+number+of+password&type=code)<br>[checkPasswordBasedAuth](https://github.com/search?q=checkPasswordBasedAuth&type=code)<br>[username and password](https://github.com/search?q=username+and+password&type=code)<br>[ACLCheckPasswordHash](https://github.com/search?q=ACLCheckPasswordHash&type=code)<br>[tlsPasswordCallback](https://github.com/search?q=tlsPasswordCallback&type=code)<br>[bit user password](https://github.com/search?q=bit+user+password&type=code)<br>[ACLHashPassword](https://github.com/search?q=ACLHashPassword&type=code)<br>[passwords](https://github.com/search?q=passwords&type=code) |
| LOW | [data/random/insecure](https://github.com/chainguard-dev/malcontent/blob/main/rules/data/random/insecure.yara#bsd_rand) | [generate random numbers insecurely](https://man.openbsd.org/rand) | [srand](https://github.com/search?q=srand&type=code) |
| LOW | [discover/system/platform](https://github.com/chainguard-dev/malcontent/blob/main/rules/discover/system/platform.yara#uname) | [system identification](https://man7.org/linux/man-pages/man1/uname.1.html) | [uname](https://github.com/search?q=uname&type=code) |
| LOW | [discover/user/USER](https://github.com/chainguard-dev/malcontent/blob/main/rules/discover/user/USER.yara#USER) | [Looks up the USER name of the current user](https://man.openbsd.org/login.1#ENVIRONMENT) | [environ](https://github.com/search?q=environ&type=code)<br>[getenv](https://github.com/search?q=getenv&type=code)<br>[USER](https://github.com/search?q=USER&type=code) |
| LOW | [exec/dylib/address_check](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/dylib/address-check.yara#dladdr) | [determine if address belongs to a shared library](https://man7.org/linux/man-pages/man3/dladdr.3.html) | [dladdr](https://github.com/search?q=dladdr&type=code) |
| LOW | [exec/program/background](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/program/program-background.yara#waitpid) | [wait for process to exit](https://linux.die.net/man/2/waitpid) | [waitpid](https://github.com/search?q=waitpid&type=code) |
| LOW | [exec/system_controls/systemd](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/system_controls/systemd.yara#ref_systemd) | makes references to systemd | [systemd](https://github.com/search?q=systemd&type=code) |
| LOW | [fs/directory/create](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/directory/directory-create.yara#mkdir) | [creates directories](https://man7.org/linux/man-pages/man2/mkdir.2.html) | [mkdir](https://github.com/search?q=mkdir&type=code) |
| LOW | [fs/directory/remove](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/directory/directory-remove.yara#rmdir) | Uses libc functions to remove directories | [rmdir](https://github.com/search?q=rmdir&type=code) |
| LOW | [fs/file/truncate](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file/file-truncate.yara#ftruncate) | truncate a file to a specified length | [ftruncate64](https://github.com/search?q=ftruncate64&type=code) |
| LOW | [fs/file/write](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file/file-write.yara#file_write) | writes to file | [ewriteConfigOverwriteFile](https://github.com/search?q=ewriteConfigOverwriteFile&type=code) |
| LOW | [fs/lock_update](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/lock-update.yara#flock) | apply or remove an advisory lock on a file | [flock](https://github.com/search?q=flock&type=code) |
| LOW | [fs/path/etc](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/path/etc.yara#etc_path) | path reference within /etc | [/etc/sentinel.conf](https://github.com/search?q=%2Fetc%2Fsentinel.conf&type=code)<br>[/etc/myredis.conf](https://github.com/search?q=%2Fetc%2Fmyredis.conf&type=code)<br>[/etc/sysctl.conf](https://github.com/search?q=%2Fetc%2Fsysctl.conf&type=code)<br>[/etc/rc.local](https://github.com/search?q=%2Fetc%2Frc.local&type=code)<br>[/etc/redis/](https://github.com/search?q=%2Fetc%2Fredis%2F&type=code) |
| LOW | [fs/path/var](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/path/var.yara#var_path) | path reference within /var | [/var/run/redis.pid](https://github.com/search?q=%2Fvar%2Frun%2Fredis.pid&type=code) |
| LOW | [fs/tempdir/TEMP](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/tempdir/TEMP.yara#temp) | temp | [getenv](https://github.com/search?q=getenv&type=code)<br>[temp](https://github.com/search?q=temp&type=code) |
| LOW | [fs/tempfile](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/tempfile.yara#mktemp) | creates temporary files | [temp file](https://github.com/search?q=temp+file&type=code) |
| LOW | [net/http](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/http/http.yara#http) | Uses the HTTP protocol | [http](https://github.com/search?q=http&type=code) |
| LOW | [net/resolve/hostport_parse](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/resolve/hostport-parse.yara#getaddrinfo) | Network address and service translation | [freeaddrinfo](https://github.com/search?q=freeaddrinfo&type=code)<br>[getaddrinfo](https://github.com/search?q=getaddrinfo&type=code) |
| LOW | [net/socket/local_addr](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket/socket-local_addr.yara#getsockname) | [get local address of connected socket](https://man7.org/linux/man-pages/man2/getsockname.2.html) | [getsockname](https://github.com/search?q=getsockname&type=code) |
| LOW | [net/socket/peer_address](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket/socket-peer-address.yara#getpeername) | [get peer address of connected socket](https://man7.org/linux/man-pages/man2/getpeername.2.html) | [getpeername](https://github.com/search?q=getpeername&type=code) |
| LOW | [net/socket/receive](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket/socket-receive.yara#recv) | [receive a message to a socket](https://linux.die.net/man/2/recv) | [socket](https://github.com/search?q=socket&type=code)<br>[recv](https://github.com/search?q=recv&type=code) |
| LOW | [net/socket/send](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket/socket-send.yara#send) | [send a message to a socket](https://linux.die.net/man/2/send) | [socket](https://github.com/search?q=socket&type=code)<br>[send](https://github.com/search?q=send&type=code) |
| LOW | [net/url/embedded](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/url/embedded.yara#https_url) | contains embedded HTTPS URLs | [https://redis.io/topics/latency-monitor.](https://redis.io/topics/latency-monitor.)<br>[https://redis.io/commands/slowlog](https://redis.io/commands/slowlog) |
| LOW | [os/env/get](https://github.com/chainguard-dev/malcontent/blob/main/rules/os/env/get.yara#getenv) | Retrieve environment variables | [getenv](https://github.com/search?q=getenv&type=code) |
| LOW | [os/fd/epoll](https://github.com/chainguard-dev/malcontent/blob/main/rules/os/fd/epoll.yara#epoll) | [I/O event notification facility](https://linux.die.net/man/7/epoll) | [epoll_create](https://github.com/search?q=epoll_create&type=code)<br>[epoll_wait](https://github.com/search?q=epoll_wait&type=code) |
| LOW | [process/multithreaded](https://github.com/chainguard-dev/malcontent/blob/main/rules/process/multithreaded.yara#pthread_create) | [creates pthreads](https://man7.org/linux/man-pages/man3/pthread_create.3.html) | [pthread_create](https://github.com/search?q=pthread_create&type=code) |

