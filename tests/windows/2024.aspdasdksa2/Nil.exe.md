## windows/2024.aspdasdksa2/Nil.exe [ðŸ˜ˆ CRITICAL]

| RISK | KEY | DESCRIPTION | EVIDENCE |
|:--|:--|:--|:--|
| CRITICAL | [impact/degrade/win_defender](https://github.com/chainguard-dev/malcontent/blob/main/rules/impact/degrade/win_defender.yara#win_defender_exclusion) | Uses powershell to define Windows Defender exclusions | [powershell -Command "Add-MpPreference -ExclusionPath 'C:\'"](https://github.com/search?q=powershell+-Command+%22Add-MpPreference+-ExclusionPath+%27C%3A%5C%27%22&type=code) |
| MEDIUM | [anti-behavior/anti_debugger](https://github.com/chainguard-dev/malcontent/blob/main/rules/anti-behavior/anti-debugger.yara#win_debugger_present) | Detects if process is being executed within a debugger or VM | [UnhandledExceptionFilter](https://github.com/search?q=UnhandledExceptionFilter&type=code)<br>[IsDebuggerPresent](https://github.com/search?q=IsDebuggerPresent&type=code) |
| MEDIUM | [data/embedded/app_manifest](https://github.com/chainguard-dev/malcontent/blob/main/rules/data/embedded/app-manifest.yara#app_manifest) | [Contains embedded Microsoft Windows application manifest](https://learn.microsoft.com/en-us/cpp/build/reference/manifestuac-embeds-uac-information-in-manifest?view=msvc-170) | [requestedExecutionLevel](https://github.com/search?q=requestedExecutionLevel&type=code)<br>[requestedPrivileges](https://github.com/search?q=requestedPrivileges&type=code) |
| MEDIUM | [exec/shell/power](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/shell/powershell.yara#powershell) | runs powershell scripts | [powershell -Command](https://github.com/search?q=powershell+-Command&type=code) |
| MEDIUM | [impact/degrade/edr](https://github.com/chainguard-dev/malcontent/blob/main/rules/impact/degrade/edr.yara#win_kill_proc) | may be able to bypass or kill EDR software | [IsProcessorFeaturePresent](https://github.com/search?q=IsProcessorFeaturePresent&type=code)<br>[UnhandledExceptionFilter](https://github.com/search?q=UnhandledExceptionFilter&type=code)<br>[GetSystemTimeAsFileTime](https://github.com/search?q=GetSystemTimeAsFileTime&type=code)<br>[QueryPerformanceCounter](https://github.com/search?q=QueryPerformanceCounter&type=code)<br>[GetCurrentProcess](https://github.com/search?q=GetCurrentProcess&type=code)<br>[IsDebuggerPresent](https://github.com/search?q=IsDebuggerPresent&type=code)<br>[GetCurrentThread](https://github.com/search?q=GetCurrentThread&type=code)<br>[TerminateProcess](https://github.com/search?q=TerminateProcess&type=code)<br>[GetModuleHandle](https://github.com/search?q=GetModuleHandle&type=code) |
| MEDIUM | [process/terminate](https://github.com/chainguard-dev/malcontent/blob/main/rules/process/terminate/terminate.yara#TerminateProcess) | terminate a process | [TerminateProcess](https://github.com/search?q=TerminateProcess&type=code) |

