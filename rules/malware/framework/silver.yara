rule c2_implant_sliver_proto: critical {
  meta:
    description = "Sliver C2 implant"

  strings:
    $sliverpb           = "sliverpb"
    $bishopfox          = "bishopfox"
    $sliver_proto       = "sliver.proto"
    $server_store_proto = "ServerStoreLprotobuf"
    $proc_name_proto    = "ProcessNameKprotobuf"

  condition:
    filesize < 20971520 and 2 of them
}

rule c2_implant_sliver_obfuscated: high {
  meta:
    description = "Possible Sliver Linux implant"
    filetypes   = "elf"

  strings:
    $coredump     = ".CoreDump"
    $gvisor       = "HasGvisorGSOCapability"
    $proxy_func   = "ProxyFunc"
    $new_private  = "NewPrivateKey"
    $optional_asn = "SkipOptionalASN1"
    $spoofing     = "SetSpoofing"
    $append       = "AppendCertsFromPEM"
    $decrypt      = ".Decrypt"

  condition:
    filesize < 15MB and filesize > 10MB and uint32(0) == 1179403647 and all of them
}

rule c2_implant_sliver_functions: critical {
  meta:
    description = "Sliver C2 implant"

  strings:
    $sliverpb           = "GetImplantBuilds"
    $bishopfox          = "GetBeaconJitter"
    $sliver_proto       = "GetObfuscateSymbols"
    $server_store_proto = "GetBeaconID"

  condition:
    filesize < 20971520 and 2 of them
}

rule beaconjitter_xor: high {
  meta:
    description = "Sliver C2 implant"

  strings:
    $ref = "BeaconJitter" xor

  condition:
    any of them
}
