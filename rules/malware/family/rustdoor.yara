rule rustdoor : critical macos {
  meta:
    description = "Rustdoor"
	ref = "https://medium.com/s2wblog/rustdoor-and-gatedoor-a-new-pair-of-weapons-disguised-as-legitimate-software-by-suspected-34c94e558b40"
	filetypes = "macho"
	hash = "20b986b24d86d9a06746bdb0c25e21a24cb477acb36e7427a8c465c08d51c1e4"
  strings:
	$botkill = "botkill"
	$dialog = "ziptask"
	$upload = "upload_filesrc"
	$launchagents = "LaunchAgents.plist"
  condition:
	filesize > 1MB and filesize < 10MB and all of them
}


rule rustdoor_v2 : critical macos {
  meta:
    description = "Rustdoor v2"
	ref = "https://medium.com/s2wblog/rustdoor-and-gatedoor-a-new-pair-of-weapons-disguised-as-legitimate-software-by-suspected-34c94e558b40"
	filetypes = "macho"
	hash = ""
  strings:
	$cfg_daemonize = "daemonize" fullword
	$cfg_cron = "check_cron_asked" fullword
	$cfg_lock_in_cron = "lock_in_cron" fullword
  	$cfg_lock_in_dock = "lock_in_dock" fullword
  	$cfg_lock_in_launch = "lock_in_launch" fullword
  	$cfg_copy_files = "copy_files" fullword
  condition:
	filesize > 1MB and filesize < 10MB and 4 of them
}

rule rustdoor_maybe : high {
  meta:
    description = "Possibly Rustdoor"
	ref = "https://medium.com/s2wblog/rustdoor-and-gatedoor-a-new-pair-of-weapons-disguised-as-legitimate-software-by-suspected-34c94e558b40"
	filetypes = "macho"
  strings:
	$botkill = "botkill"
	$upload = "upload"
	$sleep = "sleep"
	$rmdir = "rmdir"
  condition:
	filesize > 1MB and filesize < 10MB and all of them
}
