rule conti_phrases: critical {
  meta:
    description = "Ransomware phrases used by Conti"

    ref = "https://www.zscaler.com/blogs/security-research/conti-ransomware-attacks-persist-updated-version-despite-leaks"

  strings:
    $a     = "All of your files are currently"
    $b     = "currently encrypted by"
    $c     = "If you don't know who we are"
    $d     = "It cannot be recovered"
    $e     = "recovered by any means"
    $f     = "without contacting our team"
    $g     = "DON'T TRY TO RECOVER"
    $g2    = "your data by yourselves"
    $g3    = "attempt to recover your"
    $g4    = "additional recovery software"
    $h     = "choosing the data of the lowtest"
    $i     = "we recommend choosing"
    $j     = "better for both sides"
    $k     = "contact us as soon as possible"
    $l     = "DON'T TRY TO IGNORE"
    $m     = "DON'T TRY TO CONTACT"
    $n     = "any recovery companies"
    $o     = "your internal data"
    $p     = "ready to publi"
    $q     = "on our news website"
    $r     = "you do not respond"
    $s     = "our informants in"
    $t     = "a hostile intent"
    $u     = "initiate the publication"
    $v     = "compromised data"
    $w     = "get your data back"
    $x     = "we offer you to"
    $y     = "random files completely"
    $z     = "free of charge"
    $aa    = "for further instructions"
    $ac    = "install TOR browser"
    $ad    = "torproject.org"
    $ae    = "YOU SHOULD BE AWARE"
    $af    = "We will speak only"
    $ag    = "an authorized person"
    $ah    = "CEO, top management"
    $ai    = "you are not such a person"
    $aj    = "DON'T CONTACT US"
    $ak    = "serious harm to"
    $al    = "Inform your supervisors"
    $am    = "and stay calm"
    $conti = "CONTI" fullword

  condition:
    filesize < 1MB and (($conti and 2 of them) or (4 of them))
}
