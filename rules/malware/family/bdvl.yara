rule bdvl: critical {
  meta:
    description = "bdvl rootkit"
    ref         = "https://github.com/Error996/bdvl"

  strings:
    $locate_dlysm      = "locate_dlsym"
    $libpam            = "get_libpam_symbol"
    $magicusr          = "magicusr"
    $interesting       = "interestingdir"
    $secret_connection = "secret_connection"
    $forge_procnet     = "forge_procnet"
    $dobdvutil         = "dobdvutil"
    $cleanstolen       = "cleanstolen"

  condition:
    filesize < 1MB and uint32(0) == 1179403647 and 75 % of them
}
