rule melofee_2023: critical linux {
  meta:
    description = "Melofee rootkit (2023)"
    ref         = "https://blog.exatrack.com/melofee/"

  strings:
    $loader = "/etc/intel_audio/audio | xargs kill"
    $failed = "create rootkit file failed"
    $insmod = "/sbin/insmod /etc/intel_audio/intel_audio.ko"
    $lock   = "/var/lock/%s.lock"

  condition:
    filesize < 5MB and uint32(0) == 1179403647 and 2 of them
}

rule melofee_2024: critical linux {
  meta:
    description = "Melofee rootkit (2024)"
    ref         = "https://blog.xlab.qianxin.com/analysis_of_new_melofee_variant_en/"

  strings:
    $sodl    = "/var/run/nscd/sodl-close.c"
    $hide_ok = "hide ok"
    $show_ok = "show ok"

  condition:
    filesize < 7MB and uint32(0) == 1179403647 and all of them
}
