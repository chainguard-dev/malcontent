rule mirai : critical linux {
	meta:
		description = "Mirai"
		filetypes = "elf"
		ref = "https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/"
	strings:
	   $ = "/proc/%d"
   	   $ = "/proc/cpuinfo"
       $ = "/proc/self/fd"
       $ = "/proc/stat"
       $ = "Connection closed by the peer."
       $ = "GCC: (GNU) 4"
   	   $ = "Received %zd bytes: %s"
       $ = "Received Buffer:"
 	   $ = "_READ.c"
       $ = "_WRITE.c"
       $ = "__scan_cookie.c"
       $ = "been_there_done_that"
       $ = "connectToCNC"
	condition:
	   uint32(0) == 1179403647 and filesize > 40KB and filesize < 100KB and 80% of them
}

