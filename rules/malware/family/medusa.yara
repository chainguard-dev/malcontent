rule medusa: critical linux {
  meta:
    description = "Medusa LD_PRELOAD rootkit"
    ref         = "https://github.com/ldpreload/Medusa"

  strings:
    $cloned_thread   = "DYNAMIC LINKER BUG!"
    $__execve        = "__execve" fullword
    $lxstat64        = "__lxstat64" fullword
    $syslog          = "syslog" fullword
    $LD_PRELOAD      = "LD_PRELOAD" fullword
    $LD_LIBRARY_PATH = "LD_LIBRARY_PATH" fullword
    $archloaded      = "archloaded" fullword
    $rkload          = "rkload" fullword
    $wcs             = "wcsmbsload" fullword
    $readdir64       = "readdir64" fullword

  condition:
    filesize < 2MB and 80 % of them
}
