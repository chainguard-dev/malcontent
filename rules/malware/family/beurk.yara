rule beurk: critical linux {
  meta:
    description = "BEURK userland process hider"

    filetypes = "elf,so"
    ref       = "https://github.com/unix-thrust/beurk"

  strings:
    $ = "dlsym" fullword
    $ = "__non_hooked_symbols"
    $ = "__hidden_literals"
    $ = "readdir"

  condition:
    filesize < 2MB and 3 of them
}

rule beurk_xor: critical linux {
  meta:
    description = "BEURK userland process hider (xor)"

    filetypes = "elf,so"
    ref       = "https://github.com/unix-thrust/beurk"

  strings:
    $ = "BEURK" xor(1-31) fullword
    $ = "BEURK" xor(33-255) fullword
    $ = "b3urkR0cks" xor(1-31)
    $ = "b3urkR0cks" xor(33-255)

  condition:
    filesize < 2MB and any of them
}

