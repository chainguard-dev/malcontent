rule beurk: critical linux {
  meta:
    description = "BEURK userland process hider"

    filetypes = "elf,so"
    ref       = "https://github.com/unix-thrust/beurk"

  strings:
    $ = "dlsym" fullword
    $ = "__non_hooked_symbols"
    $ = "__hidden_literals"
    $ = "readdir"

  condition:
    filesize < 2MB and 3 of them
}

rule beurk_xor: critical linux {
  meta:
    description = "BEURK userland process hider (xor)"

    filetypes = "elf,so"
    ref       = "https://github.com/unix-thrust/beurk"

  strings:
    $x_BEURK       = "BEURK" xor(1-31) fullword
    $x_BEURK2      = "BEURK" xor(33-255) fullword
    $x_b3urkR0cks  = "b3urkR0cks" xor(1-31)
    $x_b3urkR0cks2 = "b3urkR0cks" xor(33-255)

    $dlsym = "dlsym" fullword

  condition:
    filesize < 2MB and $dlsym and any of ($x*)
}
