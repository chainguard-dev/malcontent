rule beaver_tail: critical macos {
  meta:
    description = "Beaver Tail Infostealer"

    filetypes = "elf,macho"
    ref       = "https://objective-see.org/blog/blog_0x7A.html"

  strings:
    $pdown      = "/pdown" fullword
    $upload     = "Upload LDB Finshed"
    $download   = "Download Python Success!" fullword
    $uploads    = "/uploads"
    $python     = "/.pyp/python.exe"
    $multi_file = "name=\"multi_file\""
    $client_99  = "/client/99"
    $keychain   = "logkc_db" fullword
    $format     = "%1_%2_%3_%4_%5" fullword
    $ldb        = "*.ldb" fullword
    $f_down     = "pDownFinished" fullword
    $f_up       = "upLDBFinished" fullword
    $f_browser  = "setBaseBrowserUrl" fullword
    $f_client   = "clientDownFinished" fullword

  condition:
    filesize < 2MB and 3 of them
}
