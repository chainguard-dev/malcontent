rule go_tinyshell: critical {
  meta:
    description = "Tiny SHell Go open-source backdoor"

  strings:
    $ref  = "handleRunShell"
    $ref2 = "RunInBackground"
    $ref3 = "LinuxPtyWrapper"

  condition:
    filesize < 3MB and all of them
}

rule c_tinyshell: critical {
  meta:
    description = "Tiny SHell open-source backdoor"

  strings:
    $ref  = "_tshd_runshell"
    $ref2 = "_tshd_get_file"

  condition:
    filesize < 1MB and all of them
}

