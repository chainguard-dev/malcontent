private rule legal_license {
  strings:
    $ = "using, exploiting or modifying the Software"
    $ = "exploit the Information commercially"
    $ = "otherwise exploited by anyone for any purpose"

  condition:
    any of them
}

rule exploitation: medium {
  meta:
    description = "References 'exploitation'"

  strings:
    $ref            = "exploiter" fullword
    $ref8           = "exploiting" fullword
    $ref9           = "exploitation" fullword
    $ref7           = "Exploiting" fullword
    $not_ms_example = "Drive-by Compromise"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule install_exploit: high {
  meta:
    description = "References exploit installation"

  strings:
    $ref            = "install_exploit" fullword
    $ref2           = "exploit_install" fullword
    $ref3           = "install exploit" fullword
    $not_ms_example = "Drive-by Compromise"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule explot: high {
  meta:
    description = "References 'explot'"

  strings:
    $ref = "explot" ascii fullword

    $not1 = { AD }  // soft hyphen
    $not2 = { 20 02 }  // Nko letter N

  condition:
    any of them and none of ($not*)
}

rule Exploit: medium {
  meta:
    description = "References an exploit"

  strings:
    $ref6          = "Exploit" fullword
    $not_reduction = "Exploit reduction"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule exploiter: high {
  meta:
    description = "References an exploit"

  strings:
    $ref2           = "EXPLOITER" fullword
    $ref3           = "sploit" fullword
    $ref4           = "spl0it" fullword
    $ref5           = "pop a shell" fullword
    $not_ms_example = "Drive-by Compromise"
    $not_pypi_index = "testpack-id-lb001"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule exploit_attempt: high {
  meta:
    description = "References an exploit attempt"

  strings:
    $ = /\wxploit succe\w{0,16}/
    $ = /\wxploit fail\w{0,16}/
    $ = /\wttempting exploit{0,16}/

  condition:
    any of them
}
