private rule legal_license {
  strings:
    $ = "using, exploiting or modifying the Software"
    $ = "exploit the Information commercially"
    $ = "otherwise exploited by anyone for any purpose"

  condition:
    any of them
}

rule exploitation: medium {
  meta:
    description = "References 'exploitation'"

  strings:
    $ref            = "exploiter" fullword
    $ref8           = "exploiting" fullword
    $ref9           = "exploitation" fullword
    $ref7           = "Exploiting" fullword
    $not_ms_example = "Drive-by Compromise"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule Exploit: medium {
  meta:
    description = "References an exploit"

  strings:
    $ref6          = "Exploit" fullword
    $not_reduction = "Exploit reduction"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule exploiter: high {
  meta:
    description = "References an exploit"

    hash_2023_0xShell_0xShellori = "506e12e4ce1359ffab46038c4bf83d3ab443b7c5db0d5c8f3ad05340cb09c38e"
    hash_2023_0xShell_wesoori    = "bab1040a9e569d7bf693ac907948a09323c5f7e7005012f7b75b5c1b2ced10ad"

  strings:
    $ref2           = "EXPLOITER" fullword
    $ref3           = "sploit" fullword
    $ref4           = "spl0it" fullword
    $ref5           = "pop a shell" fullword
    $not_ms_example = "Drive-by Compromise"

  condition:
    any of ($ref*) and none of ($not*) and not legal_license
}

rule exploit_attempt: high {
  meta:
    description = "References an exploit attempt"

  strings:
    $ = /\wxploit succe\w{0,16}/
    $ = /\wxploit fail\w{0,16}/
    $ = /\wttempting exploit{0,16}/

  condition:
    any of them
}
