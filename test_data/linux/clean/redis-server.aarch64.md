## linux/clean/redis-server.aarch64 [ðŸ”¥ HIGH]

|  RISK  |                                                                               KEY                                                                                |                                                    DESCRIPTION                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        EVIDENCE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HIGH   | [combo/degrader/linux_paths](https://github.com/chainguard-dev/malcontent/blob/main/rules/combo/degrader/linux_paths.yara#linux_critical_system_paths_small_elf) | ELF accesses multiple critical Linux paths                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| MEDIUM | [dylib/symbol/address](https://github.com/chainguard-dev/malcontent/blob/main/rules/dylib/symbol-address.yara#dlsym)                                             | [get the address of a symbol](https://man7.org/linux/man-pages/man3/dlsym.3.html)                                 | [dlsym](https://github.com/search?q=dlsym&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| MEDIUM | [exec/cmd](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/cmd.yara#exec)                                                                      | executes a command                                                                                                | [execCommandAbort](https://github.com/search?q=execCommandAbort&type=code)<br>[replicaStartCommandStream](https://github.com/search?q=replicaStartCommandStream&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MEDIUM | [exec/program](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/program.yara#execve)                                                            | executes external programs                                                                                        | [execve](https://github.com/search?q=execve&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| MEDIUM | [exec/shell_echo](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/shell_echo.yara#elf_calls_shell_echo)                                        | [program generates text with echo command](https://linux.die.net/man/1/echo)                                      | [echo 'maxmemory 128mb'](https://github.com/search?q=echo+%27maxmemory+128mb%27&type=code)<br>[echo madvise > /sys/kernel/mm/transparent_hugepage/enabled' as root](https://github.com/search?q=echo+madvise+%3E+%2Fsys%2Fkernel%2Fmm%2Ftransparent_hugepage%2Fenabled%27+as+root&type=code)<br>[echo never > /sys/kernel/mm/transparent_hugepage/enabled'](https://github.com/search?q=echo+never+%3E+%2Fsys%2Fkernel%2Fmm%2Ftransparent_hugepage%2Fenabled%27&type=code)<br>[echo tsc > /sys/devices/system/clocksource/clocksource0/current_clock](https://github.com/search?q=echo+tsc+%3E+%2Fsys%2Fdevices%2Fsystem%2Fclocksource%2Fclocksource0%2Fcurrent_clock&type=code)                                                                                                                                                                                                                                                                                                                                       |
| MEDIUM | [fs/file/times/set](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file-times-set.yara#shell_toucher)                                           | change file timestamps                                                                                            | [touch the specified keys](https://github.com/search?q=touch+the+specified+keys&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MEDIUM | [fs/permission/modify](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/permission-modify.yara#chmod)                                             | [modifies file permissions](https://linux.die.net/man/1/chmod)                                                    | [chmod](https://github.com/search?q=chmod&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| MEDIUM | [net/http/post](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/http-post.yara#http_post)                                                       | submits content to websites                                                                                       | [POST](https://github.com/search?q=POST&type=code)<br>[http](https://github.com/search?q=http&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| MEDIUM | [net/ip/parse](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/ip-parse.yara#inet_pton)                                                         | parses IP address (IPv4 or IPv6)                                                                                  | [inet_pton](https://github.com/search?q=inet_pton&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MEDIUM | [net/ip/string](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/ip-string.yara#inet_ntoa)                                                       | [converts IP address from byte to string](https://linux.die.net/man/3/inet_ntoa)                                  | [inet_ntop](https://github.com/search?q=inet_ntop&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MEDIUM | [net/reuseport](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/reuseport.yara#reuseport)                                                       | reuse TCP/IP ports for listening and connecting                                                                   | [SO_REUSEADDR](https://github.com/search?q=SO_REUSEADDR&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| MEDIUM | [persist/pid_file](https://github.com/chainguard-dev/malcontent/blob/main/rules/persist/pid_file.yara#pid_file)                                                  | pid file, likely DIY daemon                                                                                       | [/var/run/redis.pid](https://github.com/search?q=%2Fvar%2Frun%2Fredis.pid&type=code)<br>[createPidFile](https://github.com/search?q=createPidFile&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MEDIUM | [process/name/set](https://github.com/chainguard-dev/malcontent/blob/main/rules/process/name-set.yara#__progname)                                                | [get or set the current process name](https://stackoverflow.com/questions/273691/using-progname-instead-of-argv0) | [__progname](https://github.com/search?q=__progname&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| MEDIUM | [process/username/get](https://github.com/chainguard-dev/malcontent/blob/main/rules/process/username-get.yara#whoami)                                            | [returns the user name running this process](https://man7.org/linux/man-pages/man1/whoami.1.html)                 | [whoami](https://github.com/search?q=whoami&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| MEDIUM | [procfs/arbitrary/pid](https://github.com/chainguard-dev/malcontent/blob/main/rules/procfs/arbitrary-pid.yara#proc_arbitrary)                                    | access /proc for arbitrary pids                                                                                   | [/proc/%ld/smaps](https://github.com/search?q=%2Fproc%2F%25ld%2Fsmaps&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| MEDIUM | [ref/daemon](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/daemon.yara#daemon)                                                                | Run as a background daemon                                                                                        | [daemonize](https://github.com/search?q=daemonize&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MEDIUM | [ref/ip_port](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/ip_port.yara#ip_and_port)                                                         | mentions an IP and port                                                                                           | [IP](https://github.com/search?q=IP&type=code)<br>[bus_port](https://github.com/search?q=bus_port&type=code)<br>[host_port](https://github.com/search?q=host_port&type=code)<br>[master_port](https://github.com/search?q=master_port&type=code)<br>[prev_ip](https://github.com/search?q=prev_ip&type=code)<br>[tcp_port](https://github.com/search?q=tcp_port&type=code)<br>[updatePort](https://github.com/search?q=updatePort&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MEDIUM | [ref/path/relative](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/path/relative.yara#relative_path_val)                                       | references and possibly executes relative path                                                                    | [./redis-check-aof](https://github.com/search?q=.%2Fredis-check-aof&type=code)<br>[./redis-server](https://github.com/search?q=.%2Fredis-server&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MEDIUM | [ref/path/tmp](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/path/tmp.yara#tmp_path)                                                          | path reference within /tmp                                                                                        | [/tmp/dump.bin](https://github.com/search?q=%2Ftmp%2Fdump.bin&type=code)<br>[/tmp/dump.hex](https://github.com/search?q=%2Ftmp%2Fdump.hex&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| MEDIUM | [ref/words/exclamation](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/words/exclamation.yara#exclamations)                                    | gets very excited                                                                                                 | [Check your memory ASAP !!!](https://github.com/search?q=Check+your+memory+ASAP+%21%21%21&type=code)<br>[Sentinel was not able to save the new configuration on disk!!!](https://github.com/search?q=Sentinel+was+not+able+to+save+the+new+configuration+on+disk%21%21%21&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| MEDIUM | [ref/words/heartbeat](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/words/heartbeat.yara#heartbeat)                                           | references a 'heartbeat'                                                                                          | [RM_SendChildHeartbeat](https://github.com/search?q=RM_SendChildHeartbeat&type=code)<br>[RedisModule_SendChildHeartbeat](https://github.com/search?q=RedisModule_SendChildHeartbeat&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| LOW    | [dylib/address/check](https://github.com/chainguard-dev/malcontent/blob/main/rules/dylib/address-check.yara#dladdr)                                              | [determine if address belongs to a shared library](https://man7.org/linux/man-pages/man3/dladdr.3.html)           | [dladdr](https://github.com/search?q=dladdr&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| LOW    | [env/USER](https://github.com/chainguard-dev/malcontent/blob/main/rules/env/USER.yara#USER)                                                                      | [Looks up the USER name of the current user](https://man.openbsd.org/login.1#ENVIRONMENT)                         | [USER](https://github.com/search?q=USER&type=code)<br>[getenv](https://github.com/search?q=getenv&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LOW    | [exec/program/background](https://github.com/chainguard-dev/malcontent/blob/main/rules/exec/program-background.yara#waitpid)                                     | [wait for process to exit](https://linux.die.net/man/2/waitpid)                                                   | [waitpid](https://github.com/search?q=waitpid&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| LOW    | [fd/epoll](https://github.com/chainguard-dev/malcontent/blob/main/rules/fd/epoll.yara#epoll)                                                                     | [I/O event notification facility](https://linux.die.net/man/7/epoll)                                              | [epoll_create](https://github.com/search?q=epoll_create&type=code)<br>[epoll_wait](https://github.com/search?q=epoll_wait&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [fs/directory/create](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/directory-create.yara#mkdir)                                               | [creates directories](https://man7.org/linux/man-pages/man2/mkdir.2.html)                                         | [mkdir](https://github.com/search?q=mkdir&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [fs/directory/remove](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/directory-remove.yara#rmdir)                                               | Uses libc functions to remove directories                                                                         | [rmdir](https://github.com/search?q=rmdir&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [fs/file/delete](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file-delete.yara#unlink)                                                        | [deletes files](https://man7.org/linux/man-pages/man2/unlink.2.html)                                              | [unlink](https://github.com/search?q=unlink&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| LOW    | [fs/file/truncate](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file-truncate.yara#ftruncate)                                                 | truncate a file to a specified length                                                                             | [ftruncate64](https://github.com/search?q=ftruncate64&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| LOW    | [fs/file/write](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/file-write.yara#file_write)                                                      | writes to file                                                                                                    | [ewriteConfigOverwriteFile](https://github.com/search?q=ewriteConfigOverwriteFile&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LOW    | [fs/lock/update](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/lock-update.yara#flock)                                                         | apply or remove an advisory lock on a file                                                                        | [flock](https://github.com/search?q=flock&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [fs/tempfile/create](https://github.com/chainguard-dev/malcontent/blob/main/rules/fs/tempfile-create.yara#mktemp)                                                | Uses mktemp to create temporary files                                                                             | [temp file](https://github.com/search?q=temp+file&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LOW    | [kernel/platform](https://github.com/chainguard-dev/malcontent/blob/main/rules/kernel/platform.yara#uname)                                                       | [system identification](https://man7.org/linux/man-pages/man1/uname.1.html)                                       | [uname](https://github.com/search?q=uname&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [net/hostport/parse](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/hostport-parse.yara#getaddrinfo)                                           | Network address and service translation                                                                           | [freeaddrinfo](https://github.com/search?q=freeaddrinfo&type=code)<br>[getaddrinfo](https://github.com/search?q=getaddrinfo&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| LOW    | [net/socket/listen](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket-listen.yara#listen)                                                  | listen on a socket                                                                                                | [accept](https://github.com/search?q=accept&type=code)<br>[listen](https://github.com/search?q=listen&type=code)<br>[socket](https://github.com/search?q=socket&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| LOW    | [net/socket/local/address](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket-local-address.yara#getsockname)                               | [get local address of connected socket](https://man7.org/linux/man-pages/man2/getsockname.2.html)                 | [getsockname](https://github.com/search?q=getsockname&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| LOW    | [net/socket/peer/address](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket-peer-address.yara#getpeername)                                 | [get peer address of connected socket](https://man7.org/linux/man-pages/man2/getpeername.2.html)                  | [getpeername](https://github.com/search?q=getpeername&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| LOW    | [net/socket/receive](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket-receive.yara#recv)                                                  | [receive a message to a socket](https://linux.die.net/man/2/recv)                                                 | [recv](https://github.com/search?q=recv&type=code)<br>[socket](https://github.com/search?q=socket&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LOW    | [net/socket/send](https://github.com/chainguard-dev/malcontent/blob/main/rules/net/socket-send.yara#send)                                                        | [send a message to a socket](https://linux.die.net/man/2/send)                                                    | [send](https://github.com/search?q=send&type=code)<br>[socket](https://github.com/search?q=socket&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LOW    | [process/multithreaded](https://github.com/chainguard-dev/malcontent/blob/main/rules/process/multithreaded.yara#pthread_create)                                  | [creates pthreads](https://man7.org/linux/man-pages/man3/pthread_create.3.html)                                   | [pthread_create](https://github.com/search?q=pthread_create&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| LOW    | [random/insecure](https://github.com/chainguard-dev/malcontent/blob/main/rules/random/insecure.yara#bsd_rand)                                                    | [generate random numbers insecurely](https://man.openbsd.org/rand)                                                | [srand](https://github.com/search?q=srand&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [ref/path/etc](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/path/etc.yara#etc_path)                                                          | path reference within /etc                                                                                        | [/etc/myredis.conf](https://github.com/search?q=%2Fetc%2Fmyredis.conf&type=code)<br>[/etc/rc.local](https://github.com/search?q=%2Fetc%2Frc.local&type=code)<br>[/etc/redis/](https://github.com/search?q=%2Fetc%2Fredis%2F&type=code)<br>[/etc/sentinel.conf](https://github.com/search?q=%2Fetc%2Fsentinel.conf&type=code)<br>[/etc/sysctl.conf](https://github.com/search?q=%2Fetc%2Fsysctl.conf&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| LOW    | [ref/path/var](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/path/var.yara#var_path)                                                          | path reference within /var                                                                                        | [/var/run/redis.pid](https://github.com/search?q=%2Fvar%2Frun%2Fredis.pid&type=code)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LOW    | [ref/site/url](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/site/url.yara#https_url)                                                         | contains embedded HTTPS URLs                                                                                      | [https://redis.io/commands/slowlog](https://redis.io/commands/slowlog)<br>[https://redis.io/topics/latency-monitor.](https://redis.io/topics/latency-monitor.)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| LOW    | [ref/words/password](https://github.com/chainguard-dev/malcontent/blob/main/rules/ref/words/password.yara#password)                                              | references a 'password'                                                                                           | [ACLCheckPasswordHash](https://github.com/search?q=ACLCheckPasswordHash&type=code)<br>[ACLHashPassword](https://github.com/search?q=ACLHashPassword&type=code)<br>[authentication password for the default](https://github.com/search?q=authentication+password+for+the+default&type=code)<br>[bit user password](https://github.com/search?q=bit+user+password&type=code)<br>[checkPasswordBasedAuth](https://github.com/search?q=checkPasswordBasedAuth&type=code)<br>[for the output password](https://github.com/search?q=for+the+output+password&type=code)<br>[passwords](https://github.com/search?q=passwords&type=code)<br>[the number of password](https://github.com/search?q=the+number+of+password&type=code)<br>[tlsPasswordCallback](https://github.com/search?q=tlsPasswordCallback&type=code)<br>[username and password](https://github.com/search?q=username+and+password&type=code)<br>[username-password pair or user is](https://github.com/search?q=username-password+pair+or+user+is&type=code) |

